# Stopping Bahmni...
bahmni -i prod stop >/dev/null 2>&1
# Bahmni Stopped

# Taking Database Dump for the Primary Server...
bahmni -i prod backup --backup_type=db --options=openmrs >/dev/null 2>&1
# Database backup phase completed

# Taking incremental backup for bahmni...
mkdir -p /home/backup/release_version >/dev/null 2>&1
rsync --ignore-existing -avl --recursive /home/bahmni /home/backup/release_version/ >/dev/null 2>&1
# Incremental backup completed

# Taking backup of current inventory file and setup.yml...
cp /etc/bahmni-installer/prod /home/backup/release_version/local
cp /etc/bahmni-installer/setup.yml /home/backup/release_version/setup.yml
# Done

# nagios folder incremental backup started...
mkdir -p /home/backup/release_version/nagios
rsync --ignore-existing -avl --recursive /etc/nagios/ /home/backup/release_version/nagios >/dev/null 2>&1
# nagios folder incremental backup completed

# Taking backup of ssl.conf...
cp /etc/httpd/conf.d/ssl.conf /home/backup/release_version/ssl.conf

# Listing latest backup files(local and setup.yml and folder bahmni)
ls -lrt /home/backup/release_version

# Listing latest openmrs database dump
ls -lrt /data/openmrs/ | head -2 | tail -1 | awk '{print $9}'